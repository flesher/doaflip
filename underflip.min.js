(function(e){e.fn.underflip=function(i){var t,a,n,r,s,o,m=this,f=(e(this).height(),!1),p="animation",l="",d="Webkit Moz O ms Khtml".split(" "),c="";if(t=e.extend({init:"open",trigger:"click",perspective:600,axis:"X",origin:50,speed:500,ease:"ease-in",rotation:-180},i),"open"==t.init?a=0:"closed"==t.init&&(a=90),"X"==t.axis&&(n="50% "+t.origin+"%"),"Y"==t.axis&&(n=t.origin+"% 50%"),r=t.speed/1e3,m[0].style.animationName&&(f=!0),f===!1)for(var g=0;d.length>g;g++)if(void 0!==m[0].style[d[g]+"AnimationName"]){c=d[g],p=c+"Animation",l="-"+c.toLowerCase()+"-",f=!0;break}if(f===!1);else{var v="@"+l+"keyframes after { "+"from {"+l+"transform: perspective( "+t.perspective+"px ) rotate"+t.axis+"( 0deg );}"+"to {"+l+"transform: perspective( "+t.perspective+"px ) rotate"+t.axis+"( "+t.rotation+"deg );}"+"}",x="@"+l+"keyframes before { "+"from {"+l+"transform: perspective( "+t.perspective+"px ) rotate"+t.axis+"( "+t.rotation+"deg );}"+"to {"+l+"transform: perspective( "+t.perspective+"px ) rotate"+t.axis+"( 0deg );}"+"}",h=".after { "+l+"animation-timing-function: "+t.ease+";"+l+"animation-fill-mode: forwards;"+l+"animation-name: after;"+l+"animation-duration: "+r+"s;"+"}",b=".before { "+l+"animation-timing-function: "+t.ease+";"+l+"animation-fill-mode: forwards;"+l+"animation-name: before;"+l+"animation-duration: "+r+"s;"+"}";if(0==e("#anim-style").length){var u=document.createElement("style");u.id="anim-style",document.getElementsByTagName("head")[0].appendChild(u),u.innerHTML=v+x+h+b}else e("#anim-style").html(v+x+h+b)}return m.css({"-webkit-transform":"perspective( 600px ) rotateX( "+a+"deg )","-webkit-transform-origin":n,"-webkit-transition":"opacity 1s ease-in"}),s=m.hasClass("after"),o=m.hasClass("before"),s?(m.removeClass("after"),m.addClass("before")):(o&&m.removeClass("before"),m.addClass("after")),m}})(jQuery);